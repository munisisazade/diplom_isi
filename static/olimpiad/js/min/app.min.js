/*!
 * Olympiad
 * http://example.url/
 * @author Labrin
 * @author-url http://labrin.net/
 * @version 0.1.0
 * @updated 2017-10-28 */

function getCookie(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var a=jQuery.trim(n[o]);if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function digit(e){return 1===String(e).length?"0"+String(e):String(e)}function next(){clickState=!1,double_chance=!1,click_count=0,setTimeout(function(){var e=$(".nav-tabs li > .active");$(".stars > i.star-yellow:last").next().addClass("star-yellow"),e.parent().next("li").find("a").trigger("click"),e.removeClass("active"),e.parent().next("li").find("a").addClass("active")},200)}function load_more_friends(e){var t=String($(e).attr("data-page-count")),n=new FormData;n.append("count",t),$.ajax({url:"/dashboard/",type:"POST",data:n,processData:!1,contentType:!1,success:function(e){e&&($(".paginator").remove(),$(".dashboard-body").append(e)),e.error&&console.log("error")}})}function check_answer(e){var t=new FormData;t.append("question_id",$(e).attr("data-question-id")),t.append("answer_id",$(e).attr("data-answer-id")),t.append("count",$(".tab-content > .active").attr("data-count")),$.ajax({url:"/online/test/",type:"POST",data:t,processData:!1,contentType:!1,success:function(t){"False"===t?($(e).addClass("false-answer"),window.two_answer?window.two_answer=!1:(window.onbeforeunload=null,window.location.href="/results/")):"True"===t?(window.two_answer=!1,$(e).addClass("right-answer"),next()):t.token?($(e).addClass("false-answer"),window.onbeforeunload=null,window.location.href="/results/"):($(e).addClass("right-answer"),window.onbeforeunload=null,window.location.href="/results/")}})}(function(){$(function(){return console.log("hello world!")})}).call(this),csrftoken=getCookie("csrftoken"),$(document).ready(function(){function e(){1==i.paused?(i.play(),t()):(i.pause(),t())}function t(){0==i.paused?($(".pause-button").show(),$(".play-button").hide()):($(".pause-button").hide(),$(".play-button").show())}function n(e,t){return parseInt(Math.floor(Math.random()*(t-e+1)+e))}function o(e){$(i).attr("src","../../static/olimpiad/mp3/"+c[e]),i.play(),t(),r++}function a(){o(r>=8?l[r=0]:r>=4?r:l[r])}$.ajaxSetup({beforeSend:function(e,t){csrfSafeMethod(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",csrftoken)}});var i,s,c=["1.mp3","2.mp3","3.mp3","4.mp3","5.mp3","6.mp3","7.mp3","8.mp3"],r=0,l=function(){for(var e=[],t=n(1,4);e.length<4;)e.includes(t)?t=n(1,4):e.push(t);return e}();$(window).width()>992&&$("section").is(".music-start")?((i=document.querySelector("#web-song")).volume=.5,$(".volume-progress-bar").css("width",100*i.volume+"px")):$("section").is(".music-start")&&((i=document.querySelector("#mobile-song")).volume=.5,$(".volume-progress-bar").css("width",100*i.volume+"px")),$("section").is(".auto-start")&&o(l[r]),$("section").is(".music-start")&&($(".play-button").click(function(){e()}),i.onended=function(){a()},$(".pause-button").click(function(){e()}),$(".volume").mousedown(function(e){s=Math.floor(e.pageX-$(this).offset().left),$(".volume-progress-bar").css("width",s+"px"),i.volume=s/100,1==i.muted&&i.volume>0&&(i.muted=!1,$(".mute-drop").hide())}),$(".mute").click(function(e){e.preventDefault(),0==i.muted?(i.muted=!0,$(".mute-drop").show(),s=0,$(".volume-progress-bar").css("width",s+"px")):(i.muted=!1,$(".mute-drop").hide(),s=100*i.volume,$(".volume-progress-bar").css("width",s+"px"))})),$(".week").click(function(){$(".month-table").hide(),$(".result-table").hide(),$(".week-table").show(),$(this).addClass("hist-active"),$(".month").removeClass("hist-active"),$(".result").removeClass("hist-active")}),$(".fb").click(function(e){return e.preventDefault(),window.open($(this).attr("href"),"fbShareWindow","height=450, width=550, top="+($(window).height()/2-275)+", left="+($(window).width()/2-225)+", toolbar=0, location=0, menubar=0, directories=0, scrollbars=0"),!1}),$(".share").click(function(e){e.preventDefault(),$("section").is("#game")?confirm("Oyundan çıxmağınıza əminsiniz?")&&(window.onbeforeunload=null,$(window).width()<992?window.location="/share/?mobile=true":window.location="/share/"):(window.onbeforeunload=null,$(window).width()<992?window.location="/share/?mobile=true":window.location="/share/")}),$(".month").click(function(){$(".week-table").hide(),$(".result-table").hide(),$(".month-table").show(),$(this).addClass("hist-active"),$(".week").removeClass("hist-active"),$(".result").removeClass("hist-active")}),$(".result").click(function(){$(".month-table").hide(),$(".week-table").hide(),$(".result-table").show(),$(this).addClass("hist-active"),$(".week").removeClass("hist-active"),$(".month").removeClass("hist-active")}),$("#game-hamburger-btn").click(function(){$(".mobile-slide").animate({right:"0"},500)}),$("#game-hamburger-close").click(function(){$(".mobile-slide").animate({right:"-100%"},500)}),$(".help-1").click(function(){if($(this).hasClass("joker-color"))return!1;$(this).addClass("joker-color");var e=new FormData;e.append("q_id",$(".tab-pane.active:last").attr("data-id")),$.ajax({url:"/question/half/",type:"POST",data:e,processData:!1,contentType:!1,success:function(e){console.log(e.object),$(".tab-pane.active:last > .answers .answer").map(function(t,n){$(n).attr("data-answer-id")!==String(e.object[0])&&$(n).attr("data-answer-id")!==String(e.object[1])&&$(n).hide()})}})}),$(".help-2").click(function(){if($(this).hasClass("joker-color"))return!1;$(this).addClass("joker-color");var e=new FormData;e.append("q_id",$(".tab-pane.active:last").attr("data-id")),e.append("count",$(".tab-pane.active:last").attr("data-count")),e.append("q_list",$("#game-id-list").val()),$.ajax({url:"/question/change/",type:"POST",data:e,processData:!1,contentType:!1,success:function(e){e.error||(window.two_answer=!1,$(".tab-pane.active:last").replaceWith(e),is_question_changed=!0,$(".answer-item").click(function(e){is_question_changed&&!double_chance?(is_question_changed=!1,$(this).parent().hasClass("false-answer")||$(this).parent().hasClass("right-answer")||click_count++,clickState?double_chance&&click_count<=2&&check_answer($(this).parent()):(clickState=!0,check_answer($(this).parent()))):double_chance&&is_question_changed&&($(this).parent().hasClass("false-answer")||$(this).parent().hasClass("right-answer")||click_count++,clickState?double_chance&&click_count<=2&&check_answer($(this).parent()):(clickState=!0,check_answer($(this).parent())))}))}})}),$(".help-3").click(function(){if(double_chance=!0,$(this).hasClass("joker-color"))return!1;$(this).addClass("joker-color");var e=new FormData;e.append("q_id",$(".tab-pane.active:last").attr("data-id")),$.ajax({url:"/question/two/",type:"POST",data:e,processData:!1,contentType:!1,success:function(e){e.error?alert(e.error):window.two_answer=!0}})}),$(".history-date").click(function(){document.querySelectorAll(".history-date").forEach(function(e){e.classList.remove("hist-active")}),$(this).removeClass("hist-color"),$(this).addClass("hist-active")}),$(".history").click(function(){if($("section").is(".in-game")){if(!confirm("Oyundan çıxmağınıza əminsiniz?"))return!1;window.onbeforeunload=null,window.location="/history/"}else window.onbeforeunload=null,window.location="/history/"}),$(".days-btn").click(function(){document.querySelectorAll(".days-btn").forEach(function(e){e.classList.remove("hist-active")}),$(this).removeClass("hist-color"),$(this).addClass("hist-active")}),$(".exit").click(function(){if($("section").is(".in-game")){if(!confirm("Oyundan çıxmağınıza əminsiniz?"))return!1;window.onbeforeunload=null,window.location="/"}else window.onbeforeunload=null,window.location="/"}),$(".exit-modal").click(function(e){e.preventDefault(),$(".overlay").remove()}),$(".res-exit").click(function(){if(!confirm("Oyundan çıxmağınıza əminsiniz?"))return!1;window.onbeforeunload=null,window.location="/"}),$("section").is("#game")&&(window.onbeforeunload=function(e){var t="Important: Please click on 'Save' button to leave this page.";return void 0===e&&(e=window.event),e&&(e.returnValue=t),t}),$("section").is(".go-back")&&(window.onhashchange=function(){window.location="/"}),$(".play-btn").click(function(){window.onbeforeunload=null}),$(".safety").click(function(){window.onbeforeunload=null}),$(".safe-exit").click(function(){$(document).click(!1),window.onbeforeunload=null,window.location="/dashboard/"})});var minutes=0,seconds=0,end_counter=3;$(document).ready(function(){setInterval(function(){(new Date).getTime();var e=$(".start_count");if(0==(end_counter-=1)){$(".must_be_hide").remove();setInterval(function(){(new Date).getTime();if(60===(seconds+=1)&&(seconds-=60,minutes+=1),!document.getElementById("time"))return!1;document.getElementById("time").innerHTML=digit(minutes)+":"+digit(seconds)},1e3)}if(!e)return!1;e.map(function(e,t){t.innerHTML=Number(end_counter)})},1e3)});var falseAnswer=!1,double_chance=0,click_count=0,clickState=!1;$(document).ready(function(){$(".answer-questions").click(function(e){$(this).is("false-answer")||$(this).is("right-answer")||click_count++,clickState?double_chance&&click_count<=2&&(check_answer(this),console.log("Send double")):(clickState=!0,check_answer(this))})});